$schema: "http://json-schema.org/draft-07/schema#"

$id: _definitions

common:
  type: object
  properties:
    id:  # surrogate key generated by system
      type: string
      pattern: "^[A-Z]{2}[0-9]+$"
      readOnly: true  # this makes `id` immutable once created
    submitter_id:
      type: string
      pattern: "^[a-zA-Z]{1}[a-zA-Z0-9_-]*[a-zA-Z0-9]{1}$"
    date:
      type: string
      format: date
    date_time:
      type: string
      format: date-time
    uuid:  # surrogate key generated by system
      type: string
      pattern: "^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$"
      readOnly: true  # immutable once created
    bundle_status:
      enum:
      - "registered"  # Entity's metadata submitted, validated and stored on the server
      - "uploaded"  # All files in the bundle uploaded and stored on the server
      - "upload_failed"  # One or more files in the bundle failed uploading
      - "published"  # User or admin published the bundle (only possible after all files uploaded)
      - "suppressed"  # User or admin suppressed the bundle (no file in the bundle can be downloaded). Admin can re-publish a suppressed bundle
      - "depreciated"  # This is like 'mark deleted', bundle is depreciated but still accessible, files can not be downloaded (could have been purged from the server)
    program_short_name:
      enum:  # this lists all ARGO program's short names, dummy examples here for now
      - OICR-PACA
      - OICR-PRCA

data_object:
  type: object
  required: [ name, local_path, size, checksum, checksum_type ]
  properties:
    id:
      $ref: "#/common/properties/uuid"
    name:  # if omitted, name will be original file name from local_path
      type: string
    local_path:  # full path includes path and file name
      type: string
    size:
      type: integer
      minimum: 0
    checksum:
      type: string
    checksum_type:
      enum: [ md5, sha256, sha512 ]
    format:
      enum: [ TXT, PDF, BAM, BAI, CRAM, CRAI, FA, FASTA, FASTQ, VCF, TBI, IDX, TGZ ]
    extension:
      enum:
      - ".bam"
      - ".bam.bai"
      - ".cram"
      - ".cram.crai"
      - ".fastq.gz"
      - ".fq.gz"
      - ".vcf.gz"
      - ".vcf.gz.tbi"
      - ".tgz"
      - ".fa.gz"
      - ".fasta.gz"
      - ".txt.gz"
      - ".tsv.gz"
      - ".csv.gz"
      - ".pdf.gz"
    data_type:
      enum:
      - "Sequencing Reads"
      - "Unaligned Sequencing Reads"
      - "Aligned Sequencing Reads"
      - "Aligned Sequencing Reads Index"
      - "Read Group QC Metrics"
      - "Alignment QC Plot"
      - "Alignment QC Metrics"
      - "SSM"
      - "CNSM"
      - "StSM"
      - "SGV"
