$schema: "http://dcc.icgc-argo.org/draft-00/schema#"

$id: "surgery"
title: Surgery
version: 0
category: clinical
type: object
description: ""
additionalProperties: false

systemProperties:
  properties:
    id:  # primary key, defined in 'primaryKey'
      $ref: _definitions#/common/properties/uuid

required:
- type
- submitter_id
- treatment_submitter_id
- program

primaryKey:
  surrogateKey: [ id ]

uniqueKeys:
- [ program, treatment_submitter_id ]  # this ensures one-to-one relationship between treatment and surgery

references:
- selfKey: [ program, treatment_submitter_id ]
  reference:
    targetEntity: treatment  # surgery has one-to-one relationship with treatment, one treatment can have only one surgery
    targetKey: [ program, submitter_id ]

properties:
  type:
    const: "surgery"
  program:
    $ref: _definitions#/common/properties/program_short_name
  treatment_submitter_id:
    $ref: _definitions#/common/properties/submitter_id
  procedure_interval:
    type: integer
    description: Interval between primary diagnosis and surgery procedure, in days
  procedure_type:
    enum:
    - surgical resection of primary
    - surgical resection of local recurrence
    - surgical resection of distant recurrence (metastasis)
    - lymph node dissection performed at time of resection of primary.
    - biopsy of primary
    - biopsy of local recurrence
    - biopsy of distant recurrence.
    - other
  procedure_site:
    type: string
    scriptValidations:
    - "$cv(anatomic_site)"
    description: Anatomical site of the procedure
  resection_status:
    enum:
    - R0 - no apparent residual disease.
    - R1 - microscopic residual disease.
    - R2 - gross residual disease.
    - For resection procedures, an indication of the extent of residual disease.
