mappings:
  _doc:
    properties:
      file_autocomplete:
        fields:
          analyzed:
            analyzer: autocomplete_analyzed
            search_analyzer: lowercase_keyword
            type: text
          lowercase:
            analyzer: lowercase_keyword
            type: text
          prefix:
            analyzer: autocomplete_prefix
            search_analyzer: lowercase_keyword
            type: text
        type: keyword
      study:  # SONG study
        type: keyword
        copy_to:
        - file_autocomplete
      dataset:  # don't exist in SONG yet, but it's meant to be used for 'PCAWG', 'PCAWG2', etc
        type: keyword
        copy_to:
        - file_autocomplete
      object_id:  # data object ID
        type: keyword
        copy_to:
        - file_autocomplete
      analysis_id:  # SONG analysis object ID
        type: keyword
        copy_to:
        - file_autocomplete
      analysis_type:  # ENUM: sequencing experiment; alignment; variant calling
        type: keyword
      analysis_tool:  # eg, BWA-MEM, Sanger variant calling etc, don't have this in SONG currently
        type: keyword
        copy_to:
        - file_autocomplete
      data_type:  # ENUM: Aligned Reads, Unaligned Reads, SSM, SGV, StSM etc. Info source to be discussed
        type: keyword
      experimental_strategy:  # from SONG: experiment.libraryStrategy
        type: keyword
      reference_genome:
        properties:
          download_url:  # it's meant to be URLs pointing to files associated with a particular reference, don't have it in SONG
            type: keyword
          reference_name:  # source: SONG.referenceGenome, this could be ENUM
            type: keyword
      access:  # controlled or open
        type: keyword
      file:
        properties:
          id:  # this is for FI file ID, exists on the ICGC portal, do we still need it?
            type: keyword
          file_format:  # ENUM: VCF, BAM, TGZ, etc
            type: keyword
          file_md5sum:
            type: keyword
          file_name:
            type: keyword
            copy_to:
            - file_autocomplete
          file_size:
            type: long
          last_modified:
            type: long
          # auxiliary file usually include QC metrics
          auxiliary_file:  # the way to infer auxiliary file is to using file naming convention and file extension, eg, TGZ
            properties:
              object_id:
                type: keyword
              file_format:
                type: keyword
              file_md5sum:
                type: keyword
              file_name:
                type: keyword
              file_size:
                type: long
          index_file:  # the way to infer index file is to using file naming convention and file extension, eg, TBI, BAI etc
            properties:
              object_id:
                type: keyword
              file_format:
                type: keyword
              file_md5sum:
                type: keyword
              file_name:
                type: keyword
              file_size:
                type: long
      donors:
        type: nested
        properties:
          donor_id:
            type: keyword
            copy_to:
            - file_autocomplete
          donor_submitted_id:
            type: keyword
            copy_to:
            - file_autocomplete
          specimen:
            type: nested
            properties:
              specimen_id:
                type: keyword
                copy_to:
                - file_autocomplete
              specimen_submitted_id:
                type: keyword
                copy_to:
                - file_autocomplete
              specimen_type:
                type: keyword
                copy_to:
                - file_autocomplete
              sample:
                type: nested
                properties:
                  sample_id:
                    type: keyword
                    copy_to:
                    - file_autocomplete
                  sample_submitted_id:
                    type: keyword
                    copy_to:
                    - file_autocomplete
                  sample_type:
                    type: keyword
                    copy_to:
                    - file_autocomplete
      repositories:
        type: nested
        properties:
          repo_code:  # ENUM, predefined code for each SONG deployment
            type: keyword
          repo_name:
            type: keyword
          repo_org:
            type: keyword
          repo_country:
            type: keyword
settings:
  analysis:
    analyzer:
      autocomplete_analyzed:
        filter:
        - lowercase
        - edge_ngram
        tokenizer: standard
      autocomplete_prefix:
        filter:
        - lowercase
        - edge_ngram
        tokenizer: keyword
      lowercase_keyword:
        filter:
        - lowercase
        tokenizer: keyword
    filter:
      edge_ngram:
        max_gram: '20'
        min_gram: '1'
        side: front
        type: edge_ngram
