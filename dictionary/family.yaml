$schema: "http://dcc.icgc-argo.org/draft-00/schema#"

$id: "family"
title: Family
type: object
version: 0
category: clinical
description: ""
additionalProperties: false

systemProperties:
- id

required:
- type
- donor_submitter_id
- program

primaryKey:  # lack of natural key is permitted
  surrogateKey: [ id ]

uniqueKeys:
# this unique key blocks submision of completely duplicated record for family entity
- [ program, donor_submitter_id, donor_has_relative_with_cancer_history, relationship_type, relationship_type_other, relationship_gender, relationship_age, relationship_disease_icd10, relationship_disease ]

references:
- selfKey: [ program, donor_submitter_id ]
  reference:
    targetEntity: donor
    targetKey: [ program, submitter_id ]

properties:
  type:
    const: "family"
  id:
    $ref: _definitions#/common/properties/id
  program:
    $ref: _definitions#/common/properties/program_short_name
  donor_submitter_id:
    $ref: _definitions#/common/properties/submitter_id
  donor_has_relative_with_cancer_history:
    type: string
    scriptValidations:
      - "$cv(yes_no_unknown)"
  relationship_type:
    enum:
    - sibling
    - parent
    - grandparent
    - uncle/aunt
    - cousin
    - other
    - unknown
  relationship_type_other:
    type: string
  relationship_gender:
    enum: [ "male", "female", "unknown" ]
  relationship_age:  # shouldn't this be relationship_age_at_diagnosis
    type: integer
  relationship_disease_icd10:
    type: string
    scriptValidations:
    - "$cv(disease_icd10_code)"
  relationship_disease:
    type: string
    description: Disease name of the relative
