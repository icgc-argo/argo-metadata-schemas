$schema: "http://dcc.icgc-argo.org/draft-00/schema#"

$id: "sample"
title: Sample
version: 0
category: biospecimen
type: object
description: ""
additionalProperties: false

systemProperties:  # properties will be populated by the system
  properties:
    id:  # primary key, defined in 'primaryKey'
      allOf:
      - $ref: _definitions#/common/properties/id
      - pattern: "^SA"  # id must start with "SA", in addition to pattern defined at _definitions#/common/properties/id
    specimen_id:  # foreign key to specimen entity, the relationship is defined in 'references'
      $ref: specimen#/systemProperties/properties/id

required:
- type
- submitter_id
- specimen_submitter_id
- program
- sample_type

primaryKey:
  surrogateKey: [ id ]
  naturalKey: [ program, submitter_id ]

uniqueKeys: []  # don't need to repeat primary keys here

references:
- selfKey: [ program, specimen_submitter_id ]
  reference:
    targetEntity: specimen  # sample to specimen relationship is many-to-one
    targetKey: [ program, submitter_id ]

properties:
  type:
    const: "sample"
  program:
    $ref: _definitions#/common/properties/program_short_name
  submitter_id:
    $ref: _definitions#/common/properties/submitter_id
    description: "Submitter's sample ID"
  specimen_submitter_id:
    $ref: _definitions#/common/properties/submitter_id
  sample_type:
    type: string
    scriptValidations:
    - "$cv(sample_type)"
